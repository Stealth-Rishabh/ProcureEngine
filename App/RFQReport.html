<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Sourcing Portal</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <meta content="" name="description" />
    <meta content="" name="author" />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all"
          rel="stylesheet" type="text/css" />
    <link href="assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet"
          type="text/css" />
    <link href="assets/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet"
          type="text/css" />
    <link href="assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet"
          type="text/css" />
    <link href="assets/global/plugins/uniform/css/uniform.default.css" rel="stylesheet"
          type="text/css" />
    <link href="assets/global/plugins/bootstrap-toastr/toastr.css" rel="stylesheet" />
    <link href="assets/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css"
          rel="stylesheet" type="text/css" />
    <!--<link rel="stylesheet" type="text/css" href="assets/global/plugins/select2/select2.css" />-->
    <link rel="stylesheet" type="text/css" href="assets/plugins/select2/select2.css" />
    <link rel="stylesheet" type="text/css" href="assets/plugins/select2/select2-metronic.css" />
    <link href="assets/global/css/components.css" rel="stylesheet" type="text/css" />
    <link href="assets/global/css/plugins.css" rel="stylesheet" type="text/css" />
    <link href="assets/admin/layout/css/layout.css" rel="stylesheet" type="text/css" />
    <link id="style_color" href="assets/admin/layout/css/themes/default.css" rel="stylesheet" type="text/css" />
    <link href="assets/admin/layout/css/custom.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="assets/global/plugins/clockface/css/clockface.css" />
    <link rel="stylesheet" type="text/css" href="assets/global/plugins/bootstrap-datepicker/css/datepicker3.css" />
    <link rel="stylesheet" type="text/css" href="assets/global/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css" />
    <link rel="stylesheet" type="text/css" href="assets/global/plugins/bootstrap-colorpicker/css/colorpicker.css" />
    <link rel="stylesheet" type="text/css" href="assets/global/plugins/bootstrap-daterangepicker/daterangepicker-bs3.css" />
    <link rel="stylesheet" type="text/css" href="assets/global/plugins/bootstrap-datetimepicker/css/datetimepicker.css" />
    <link rel="shortcut icon" href="../favicon.ico" />
</head>
<body class="page-header-fixed page-quick-sidebar-over-content page-sidebar-closed">
    <div class="page-header navbar navbar-fixed-top">
        <div class="page-header-inner">
            <div class="page-logo">
                <a class="navbar-brand" href="index.html" style="padding:4px !important;">
                    <img src="assets/img/mmlogo.png" alt="logo" class="img-responsive" style="height:38px; width:180px;" />
                </a>

            </div>
            <div class="top-menu">
                <ul class="nav navbar-nav pull-right">
                    <li class="dropdown dropdown-user">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown"
                           data-hover="dropdown" data-close-others="true">
                            <!--<img alt="" class="img-circle hide1" src="assets/admin/layout/img/avatar3_small.jpg" />-->
                            <span id="spanUserName" style="font-weight: bold" class="username username-hide-on-mobile">
                            </span><i class="fa fa-angle-down"></i>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="MyProfile.html"><i class="icon-user"></i>My Profile </a></li>
                            <li><a href="javascript:void(0);" id="logOut_btn"><i class="fa fa-key"></i>Log Out </a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="clearfix">
    </div>
    <div class="page-container" style="display:none">
        <!-- BEGIN SIDEBAR -->
        <div class="page-sidebar-wrapper">
            <div class="page-sidebar navbar-collapse collapse">
                <ul class="page-sidebar-menu page-sidebar-menu-closed" data-auto-scroll="true" data-slide-speed="200" id="ulMain">
                    <li class="sidebar-toggler-wrapper">
                        <div class="sidebar-toggler hidden-phone">
                        </div>
                    </li>
                    <br />
                </ul>
            </div>
        </div>
        <div class="page-content-wrapper">
            <div class="page-content">
                <div class="modal fade" id="portlet-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
                     aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                                <h4 class="modal-title">
                                    Modal title
                                </h4>
                            </div>
                            <div class="modal-body">
                                Widget settings form goes here
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn yellow">
                                    Save changes
                                </button>
                                <button type="button" class="btn default" data-dismiss="modal">
                                    Close
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="page-bar">
                    <ul class="page-breadcrumb">
                        <li>
                            <i class="fa fa-home"></i><a href="index.html">Home</a> <i class="fa fa-angle-right">
                            </i>
                        </li>

                        <li><a href="#">RFQ  Report</a> </li>
                    </ul>
                    <div class="page-toolbar">
                        <div id="dashboard-report-range" class="pull-right btn btn-fit-height">
                            <a href="#HelpModal" data-toggle="modal" class="tooltips btn btn-xs btn-primary" data-placement="left" data-original-title="Click to see help"><i class="fa fa-question-circle"></i> Help</a>
                        </div>
                    </div>
                </div>
                <!-- END PAGE HEADER-->
                <!-- BEGIN PAGE CONTENT-->
                <div class="row">
                    <div class="col-md-12">
                        <div class="portlet box green-haze">
                            <div class="portlet-title">
                                <div class="caption">
                                    <i class="fa fa-reorder"></i>RFQ Details Report
                                    <span class="badge badge-primary" style="font-size: 13px !important;" id="spnFinalStatus"></span>
                                </div>
                                <div class="tools">
                                    <span id="lbl_ConfiguredBy" class="align-right"></span>
                                    <a id="A1" href="javascript:;" class="collapse"></a>
                                </div>
                            </div>
                            <div id="div4" class="portlet-body form">
                                <!-- BEGIN FORM-->
                                <form action="#" class="form-horizontal">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="control-label col-md-4">
                                                    RFQ Subject:
                                                </label>
                                                <div class="col-md-8">
                                                    <label id="RFQSubject" class="control-label" style="text-align:left">
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="control-label col-md-4">
                                                    Currency:
                                                </label>
                                                <div class="col-md-8">
                                                    <label id="Currency" class="control-label" style="text-align:left">
                                                    </label>
                                                    <input type="hidden" id="texttblid" value="" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="control-label col-md-4">
                                                    RFQ Description:
                                                </label>
                                                <div class="col-md-8">
                                                    <label id="RFQDescription" style="text-align:left" class="control-label">
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="control-label col-md-4">
                                                    Vendor Name:
                                                </label>
                                                <div class="col-md-8">
                                                    <label id="RFQVendorname" style="text-align:left" class="control-label">
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="control-label col-md-4">
                                                    Conversion Rate:
                                                </label>
                                                <div class="col-md-8">
                                                    <label id="ConversionRate" class="control-label" style="text-align:left">
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="control-label col-md-4">
                                                    RFQ Deadline:
                                                </label>
                                                <div class="col-md-8">
                                                    <label id="RFQDeadline" class="control-label" style="text-align:left">
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="control-label col-md-4">
                                                    Term &amp; Condition:
                                                </label>
                                                <div class="col-md-8">
                                                    <label class="control-label">
                                                        <a href="" id="TermCondition" target="_blank" style="text-align:left; text-decoration: none !important;">

                                                        </a>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                      
                                    </div>
                                  

                                </form>
                                <!-- END FORM-->
                            </div>
                        </div>
                    </div>
                   
                    <!-- END PAGE CONTENT-->
                </div>
                <div class="clearfix"></div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="portlet box blue-hoki">
                            <div class="portlet-title">
                                <div class="caption">
                                    <i class="fa fa-reorder"></i>RFQ Parameters Report
                                </div>
                                <div class="actions">
                                    <button class="btn blue tooltips display-none" type="button" id="btnExport" data-placement="left" data-original-title="Export to Excel">
                                        Export
                                    </button>
                                    <button class="btn yellow tooltips display-none" type="button" id="btnprint" data-placement="left" data-original-title="Print">
                                        Print
                                    </button>
                                    <a href="javascript::" data-placement="left" onclick="changecss()" data-original-title="Show more Filters" class="tooltips icon-circle-arrow-down" id="iconclick"></a>
                                </div>
                            </div>


                            <div id="divdomestic" class="portlet-body form" style="display: none;">
                                <!-- BEGIN FORM-->
                                <form action="#" id="formdomestic" class="form-horizontal">
                                    <div id="divalerterrordomestic" class="alert alert-danger" style='display: none; text-align: center;'>
                                        <span id="spanerrordomestic"> </span>
                                    </div>
                                    <div id="divalertsucessdomestic" class="alert alert-success" style='display: none; text-align: center;'>
                                        <span id="spansuccessdomestic">Data saved sucessfully. </span>
                                    </div>
                                    <div class="form-body">
                                        <div class="form-group">
                                            <div class="col-md-12">
                                                <a id="dlink" style="display:none;"></a>
                                                <div class="table-scrollable">
                                                    <table id="tbldetails" class="table table-striped table-bordered table-hover hide">
                                                        <thead>
                                                            <tr>
                                                                <th>RFQ Subject</th>
                                                                <th>Description</th>
                                                                <th>Vendor Name</th>
                                                                <th>Currency</th>
                                                                <th>Conversion Rate</th>
                                                                <th>RFQ Deadline</th>
                                                            </tr>
                                                        </thead>
                                                    </table>
                                                    <table class="table table-striped table-bordered table-hover" id="tblServicesProduct"></table>
                                                    
                                                </div>
                                            </div>
                                            <div id="table_wrapper">
                                                <table id="tbldetailsExcel" class="table table-striped table-bordered table-hover hide" border="1">
                                                    <thead>
                                                        <tr>
                                                            <th>RFQ Subject</th>
                                                            <th>Description</th>
                                                            <th>Currency</th>
                                                            <th>Conversion Rate</th>
                                                            <th>RFQ Deadline</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody></tbody>
                                                </table>

                                                <table class="table  hide" id="tblvendorremarks">
                                                    <tr><td style="width:150px;"><b>Vendor Remarks :<b></td><td id="vRemarks"></td></tr>
                                                </table>
                                                <br /><br />
                                                <table class="table table-striped table-bordered table-hover hide" border="1" id="tblServicesProductforexcel">
                                                    <thead></thead>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                                <!-- END FORM-->
                            </div>

                        </div>
                    </div>
                    <!--<div class="form-horizontal">-->
                    <div class="col-md-12">
                    </div>
                    <!-- END PAGE CONTENT-->
                </div>
                <!-- END PAGE CONTENT-->
            </div>
        </div>
    </div>
    <div class="page-footer">
        <div class="page-footer" style="color: #FFF !important;">
            2016 &copy; <a href="http://www.agileapt.com" target="_blank">AgileApt Solutions Pvt. Ltd.</a>
        </div>
        <div class="scroll-to-top">
            <i class="icon-arrow-up"></i>
        </div>
    </div>
    <div id="HelpModal" class="modal fade bs-modal-lg in" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="portlet box blue">
                <div class="portlet-title">
                    <div class="caption">
                        <i class="fa fa-reorder"></i>Help
                    </div>
                    <div class="tools">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                    </div>
                </div>
                <div class="portlet-body form">
                    <div class="alert alert-danger display-hide" id="errordiv1">
                        <button class="close" data-close="alert"></button>
                        <span id="errormsg"></span>
                    </div>
                    <div class="alert alert-success display-hide" id="successdiv1">
                        <button class="close" data-close="alert"></button>
                        <span id="successmsg"></span>
                    </div>
                    <div class="modal-body" style="height: 150px; overflow-y: scroll;">
                        <h4 class="ppolicy-head4"> RFQ Details Report </h4>
                        <p class="ppolicy-text">
                            <ul>
                                <li> Admin can view the RFQ details report </li>
                                <li> Admin can also export and download the report as well.</li>
                            </ul>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="assets/plugins/jquery-1.10.2.min.js" type="text/javascript"></script>

    <script src="assets/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="assets/plugins/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js"
            type="text/javascript"></script>
    <script src="assets/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>
    <script src="assets/plugins/jquery.blockui.min.js" type="text/javascript"></script>
    <script src="assets/plugins/jquery.cokie.min.js" type="text/javascript"></script>
    <script src="assets/plugins/uniform/jquery.uniform.min.js" type="text/javascript"></script>
    <script src="assets/global/plugins/bootstrap-toastr/toastr.min.js"></script>
    <!-- END CORE PLUGINS -->
    <!-- BEGIN PAGE LEVEL PLUGINS -->
    <script type="text/javascript" src="assets/plugins/jquery-validation/dist/jquery.validate.min.js"></script>
    <script type="text/javascript" src="assets/plugins/jquery-validation/dist/additional-methods.min.js"></script>
    <script type="text/javascript" src="assets/plugins/select2/select2.min.js"></script>
    <script type="text/javascript" src="assets/plugins/bootstrap-wysihtml5/wysihtml5-0.3.0.js"></script>
    <script type="text/javascript" src="assets/plugins/bootstrap-wysihtml5/bootstrap-wysihtml5.js"></script>
    <script type="text/javascript" src="assets/plugins/ckeditor/ckeditor.js"></script>
    <script type="text/javascript" src="assets/plugins/bootstrap-markdown/js/bootstrap-markdown.js"></script>
    <script type="text/javascript" src="assets/plugins/bootstrap-markdown/lib/markdown.js"></script>
    <script src="assets/CustomJS/RegisterUser.js" type="text/javascript"></script>
    <script src="assets/plugins/bootbox/bootbox.min.js" type="text/javascript"></script>
    <script src="assets/scripts/core/app.js"></script>
    <script src="assets/scripts/custom/components-pickers.js"></script>
    <script src="assets/CustomJS/Auction.js"></script>
    <script src="assets/CustomJS/RFQReport.js" type="text/javascript"></script>
    <script>
        jQuery(document).ready(function () {
            Pageloaded()
            setInterval(function () { Pageloaded() }, 15000);
            if (sessionStorage.getItem('UserID') == null || sessionStorage.getItem('UserID') == "") {
                window.location = sessionStorage.getItem('MainUrl')//"login.html";
            }
            else {
                if (sessionStorage.getItem("UserType") == "E") {
                    $('.page-container').show();
                }
                else {
                    bootbox.alert("You are not Authorize to view this page", function () {
                        parent.history.back();
                        return false;
                    });
                }
            }


            var _RFQid = getUrlVars()["RFQID"];
            var _VendorId = getUrlVars()["VendorId"];
            var _RFQVersionId = getUrlVars()["RFQVersionId"];
            var _rfqVersionText = getUrlVars()["RFQVersionTxt"];

            if (_RFQid == null) {
                sessionStorage.setItem('hddnRFQID', 0)
                sessionStorage.setItem('hddnVendorId', 0)
                sessionStorage.setItem('RFQVersionId', 0)
                $("#spnFinalStatus").hide();
            }
            else {

                sessionStorage.setItem('hddnRFQID', _RFQid)
                sessionStorage.setItem('hddnVendorId', _VendorId)
                sessionStorage.setItem('RFQVersionId', _RFQVersionId)
                fetchReguestforQuotationDetails();
                RFQFetchQuotedPriceReport()
                $("#spnFinalStatus").show().html("Version : " + _rfqVersionText.replace('%20', ' '));
            }

            setCommonData();
            fetchMenuItemsFromSession(0, 0);






        });
        jQuery('#btnpush').click(function (e) {
            jQuery('#approverList > option:selected').appendTo('#mapedapprover');
        });
        jQuery('#btnpull').click(function (e) {
            jQuery('#mapedapprover > option:selected').appendTo('#mapedapprover');
        });

    </script>
    <script type="text/javascript">

        $("#btnprint").click(function (e) {
            window.print();
        })
        $("#btnExport").click(function (e) {
           
            var dt = new Date();
            var day = dt.getDate();
            var month = dt.getMonth() + 1;
            var year = dt.getFullYear();
            var hour = dt.getHours();
            var mins = dt.getMinutes();
            var postfix = day + "." + month + "." + year + "_" + hour + "." + mins;

            //Export To Excel
            var data_type = 'data:application/vnd.ms-excel';
            var table_div = document.getElementById('table_wrapper');
            var table_html = table_div.outerHTML.replace(/ /g, '%20');

            var a = document.createElement('a');
            a.href = data_type + ', ' + table_html;
            a.download = 'RFQDetails -' + postfix + '.xls';

            a.click();



        });
    </script>
    <script type="text/javascript">
        var tableToExcel = (function () {
            var uri = 'data:application/vnd.ms-excel;base64,'
                , tmplWorkbookXML = '<?xml version="1.0"?><?mso-application progid="Excel.Sheet"?><Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">'
                    + '<DocumentProperties xmlns="urn:schemas-microsoft-com:office:office"><Author>Axel Richter</Author><Created>{created}</Created></DocumentProperties>'
                    + '<Styles>'
                    + '<Style ss:ID="Currency"><NumberFormat ss:Format="Currency"></NumberFormat></Style>'
                    + '<Style ss:ID="Date"><NumberFormat ss:Format="Medium Date"></NumberFormat></Style>'
                    + '</Styles>'
                    + '{worksheets}</Workbook>'
                , tmplWorksheetXML = '<Worksheet ss:Name="{nameWS}"><Table>{rows}</Table></Worksheet>'
                , tmplCellXML = '<Cell{attributeStyleID}{attributeFormula}><Data ss:Type="{nameType}">{data}</Data></Cell>'
                , base64 = function (s) { return window.btoa(unescape(encodeURIComponent(s))) }
                , format = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }
            return function (tables, wsnames, wbname, appname) {
                var ctx = "";
                var workbookXML = "";
                var worksheetsXML = "";
                var rowsXML = "";

                for (var i = 0; i < tables.length; i++) {
                    if (!tables[i].nodeType) tables[i] = document.getElementById(tables[i]);
                    for (var j = 0; j < tables[i].rows.length; j++) {
                        rowsXML += '<Row>'
                        for (var k = 0; k < tables[i].rows[j].cells.length; k++) {
                            var dataType = tables[i].rows[j].cells[k].getAttribute("data-type");
                            var dataStyle = tables[i].rows[j].cells[k].getAttribute("data-style");
                            var dataValue = tables[i].rows[j].cells[k].getAttribute("data-value");
                            dataValue = (dataValue) ? dataValue : tables[i].rows[j].cells[k].innerHTML;
                            var dataFormula = tables[i].rows[j].cells[k].getAttribute("data-formula");
                            dataFormula = (dataFormula) ? dataFormula : (appname == 'Calc' && dataType == 'DateTime') ? dataValue : null;
                            ctx = {
                                attributeStyleID: (dataStyle == 'Currency' || dataStyle == 'Date') ? ' ss:StyleID="' + dataStyle + '"' : ''
                                , nameType: (dataType == 'Number' || dataType == 'DateTime' || dataType == 'Boolean' || dataType == 'Error') ? dataType : 'String'
                                , data: (dataFormula) ? '' : dataValue
                                , attributeFormula: (dataFormula) ? ' ss:Formula="' + dataFormula + '"' : ''
                            };
                            rowsXML += format(tmplCellXML, ctx);
                        }
                        rowsXML += '</Row>'
                    }
                    ctx = { rows: rowsXML, nameWS: wsnames[i] || 'Sheet' + i };
                    worksheetsXML += format(tmplWorksheetXML, ctx);
                    rowsXML = "";
                }

                ctx = { created: (new Date()).getTime(), worksheets: worksheetsXML };
                workbookXML = format(tmplWorkbookXML, ctx);



                var link = document.createElement("A");
                link.href = uri + base64(workbookXML);
                link.download = wbname || 'Workbook.xls';
                link.target = '_blank';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
        })();
    </script>
</body>

</html>

